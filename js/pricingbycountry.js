
let currencyObject = {
  "AED": {
    "currency": "AED",
    "symbol": "د.إ",
    "moneyFormat": "د.إ{{amount}} AED",
    "decimal": 2
  },
  "AFN": {
    "currency": "AFN",
    "symbol": "؋",
    "moneyFormat": "Af {{amount}}",
    "decimal": 0
  },
  "ALL": {
    "currency": "ALL",
    "symbol": "L",
    "moneyFormat": "Lek {{amount}}",
    "decimal": 0
  },
  "AMD": {
    "currency": "AMD",
    "symbol": "դր.",
    "moneyFormat": "{{amount}}",
    "decimal": 0
  },
  "ANG": {
    "currency": "ANG",
    "symbol": "ƒ",
    "moneyFormat": "ƒ {{amount}}",
    "decimal": 2
  },
  "AOA": {
    "currency": "AOA",
    "symbol": "Kz",
    "moneyFormat": "Kz{{amount}}",
    "decimal": 0
  },
  "ARS": {
    "currency": "ARS",
    "symbol": "$",
    "moneyFormat": "${{amount_with_comma_separator}}",
    "decimal": 0
  },
  "AUD": {
    "currency": "AUD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "AWG": {
    "currency": "AWG",
    "symbol": "ƒ",
    "moneyFormat": "Afl{{amount}}",
    "decimal": 2
  },
  "AZN": {
    "currency": "AZN",
    "symbol": "₼",
    "moneyFormat": "₼{{amount}}",
    "decimal": 2
  },
  "BAM": {
    "currency": "BAM",
    "symbol": "КМ",
    "moneyFormat": "KM {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "BBD": {
    "currency": "BBD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "BDT": {
    "currency": "BDT",
    "symbol": "৳",
    "moneyFormat": "Tk {{amount}}",
    "decimal": 0
  },
  "BGN": {
    "currency": "BGN",
    "symbol": "лв.",
    "moneyFormat": "{{amount}} лв",
    "decimal": 2
  },
  "BIF": {
    "currency": "BIF",
    "symbol": "Fr",
    "moneyFormat": "BIF {{amount}}",
    "decimal": 0
  },
  "BMD": {
    "currency": "BMD",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 2
  },
  "BND": {
    "currency": "BND",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "BOB": {
    "currency": "BOB",
    "symbol": "Bs.",
    "moneyFormat": "Bs{{amount_with_comma_separator}}",
    "decimal": 2
  },
  "BRL": {
    "currency": "BRL",
    "symbol": "R$",
    "moneyFormat": "R$ {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "BSD": {
    "currency": "BSD",
    "symbol": "$",
    "moneyFormat": "BS${{amount}}",
    "decimal": 2
  },
  "BWP": {
    "currency": "BWP",
    "symbol": "P",
    "moneyFormat": "P{{amount}}",
    "decimal": 2
  },
  "BZD": {
    "currency": "BZD",
    "symbol": "$",
    "moneyFormat": "BZ${{amount}}",
    "decimal": 2
  },
  "CAD": {
    "currency": "CAD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "CDF": {
    "currency": "CDF",
    "symbol": "Fr",
    "moneyFormat": "FC {{amount}}",
    "decimal": 0
  },
  "CHF": {
    "currency": "CHF",
    "symbol": "CHF",
    "moneyFormat": "CHF {{amount}}",
    "decimal": 2
  },
  "CLP": {
    "currency": "CLP",
    "symbol": "$",
    "moneyFormat": "${{amount_no_decimals}}",
    "decimal": 0
  },
  "CNY": {
    "currency": "CNY",
    "symbol": "¥",
    "moneyFormat": "¥{{amount}}",
    "decimal": 2
  },
  "COP": {
    "currency": "COP",
    "symbol": "$",
    "moneyFormat": "${{amount_with_comma_separator}}",
    "decimal": 0
  },
  "CRC": {
    "currency": "CRC",
    "symbol": "₡",
    "moneyFormat": "₡ {{amount_with_comma_separator}}",
    "decimal": 0
  },
  "CVE": {
    "currency": "CVE",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 0
  },
  "CZK": {
    "currency": "CZK",
    "symbol": "Kč",
    "moneyFormat": "{{amount_with_comma_separator}} Kč",
    "decimal": 2
  },
  "DJF": {
    "currency": "DJF",
    "symbol": "Fdj",
    "moneyFormat": "DJF {{amount}}",
    "decimal": 0
  },
  "DKK": {
    "currency": "DKK",
    "symbol": "kr.",
    "moneyFormat": "kr {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "DOP": {
    "currency": "DOP",
    "symbol": "$",
    "moneyFormat": "RD$ {{amount}}",
    "decimal": 0
  },
  "DZD": {
    "currency": "DZD",
    "symbol": "د.ج",
    "moneyFormat": "DA {{amount}}",
    "decimal": 0
  },
  "EGP": {
    "currency": "EGP",
    "symbol": "ج.م",
    "moneyFormat": "LE {{amount}}",
    "decimal": 2
  },
  "ETB": {
    "currency": "ETB",
    "symbol": "Br",
    "moneyFormat": "Br{{amount}}",
    "decimal": 0
  },
  "EUR": {
    "currency": "EUR",
    "symbol": "€",
    "moneyFormat": "{{amount_with_comma_separator}}€",
    "decimal": 2
  },
  "FJD": {
    "currency": "FJD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "FKP": {
    "currency": "FKP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}}",
    "decimal": 2
  },
  "GBP": {
    "currency": "GBP",
    "symbol": "£",
    "moneyFormat": "£{{amount}}",
    "decimal": 2
  },
  "GEL": {
    "currency": "GEL",
    "symbol": "ლ",
    "moneyFormat": "{{amount}} GEL",
    "decimal": 2
  },
  "GIP": {
    "currency": "GIP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}}",
    "decimal": 2
  },
  "GMD": {
    "currency": "GMD",
    "symbol": "D",
    "moneyFormat": "D {{amount}}",
    "decimal": 0
  },
  "GNF": {
    "currency": "GNF",
    "symbol": "Fr",
    "moneyFormat": "FG {{amount}}",
    "decimal": 0
  },
  "GTQ": {
    "currency": "GTQ",
    "symbol": "Q",
    "moneyFormat": "Q{{amount}}",
    "decimal": 2
  },
  "GYD": {
    "currency": "GYD",
    "symbol": "$",
    "moneyFormat": "G${{amount}}",
    "decimal": 0
  },
  "HKD": {
    "currency": "HKD",
    "symbol": "$",
    "moneyFormat": "HK${{amount}}",
    "decimal": 2
  },
  "HNL": {
    "currency": "HNL",
    "symbol": "L",
    "moneyFormat": "L {{amount}}",
    "decimal": 2
  },
  "HRK": {
    "currency": "HRK",
    "symbol": "kn",
    "moneyFormat": "{{amount_with_comma_separator}} kn",
    "decimal": 2
  },
  "HTG": {
    "currency": "HTG",
    "symbol": "G",
    "moneyFormat": "G {{amount}}",
    "decimal": 0
  },
  "HUF": {
    "currency": "HUF",
    "symbol": "Ft",
    "moneyFormat": "{{amount_no_decimals_with_comma_separator}}",
    "decimal": 0
  },
  "IDR": {
    "currency": "IDR",
    "symbol": "Rp",
    "moneyFormat": "{{amount_with_comma_separator}} IDR",
    "decimal": 0
  },
  "ILS": {
    "currency": "ILS",
    "symbol": "₪",
    "moneyFormat": "₪{{amount}}",
    "decimal": 2
  },
  "INR": {
    "currency": "INR",
    "symbol": "₹",
    "moneyFormat": "₹ {{amount}}",
    "decimal": 0
  },
  "ISK": {
    "currency": "ISK",
    "symbol": "kr",
    "moneyFormat": "{{amount_no_decimals}} kr",
    "decimal": 0
  },
  "JMD": {
    "currency": "JMD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 0
  },
  "JPY": {
    "currency": "JPY",
    "symbol": "¥",
    "moneyFormat": "¥{{amount_no_decimals}}",
    "decimal": 0
  },
  "KES": {
    "currency": "KES",
    "symbol": "KSh",
    "moneyFormat": "KSh{{amount}}",
    "decimal": 0
  },
  "KGS": {
    "currency": "KGS",
    "symbol": "som",
    "moneyFormat": "лв{{amount}}",
    "decimal": 0
  },
  "KHR": {
    "currency": "KHR",
    "symbol": "៛",
    "moneyFormat": "KHR{{amount}}",
    "decimal": 0
  },
  "KMF": {
    "currency": "KMF",
    "symbol": "Fr",
    "moneyFormat": "CF {{amount}}",
    "decimal": 0
  },
  "KRW": {
    "currency": "KRW",
    "symbol": "₩",
    "moneyFormat": "₩{{amount_no_decimals}}",
    "decimal": 0
  },
  "KYD": {
    "currency": "KYD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "KZT": {
    "currency": "KZT",
    "symbol": "〒",
    "moneyFormat": "{{amount}} KZT",
    "decimal": 0
  },
  "LAK": {
    "currency": "LAK",
    "symbol": "₭",
    "moneyFormat": "₭ {{amount}}",
    "decimal": 0
  },
  "LBP": {
    "currency": "LBP",
    "symbol": "ل.ل",
    "moneyFormat": "L.L.{{amount}}",
    "decimal": 0
  },
  "LKR": {
    "currency": "LKR",
    "symbol": "₨",
    "moneyFormat": "Rs {{amount}}",
    "decimal": 0
  },
  "LRD": {
    "currency": "LRD",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 0
  },
  "LSL": {
    "currency": "LSL",
    "symbol": "L",
    "moneyFormat": "L {{amount}}",
    "decimal": 2
  },
  "MAD": {
    "currency": "MAD",
    "symbol": "د.م.",
    "moneyFormat": "{{amount}} dh",
    "decimal": 2
  },
  "MDL": {
    "currency": "MDL",
    "symbol": "L",
    "moneyFormat": "{{amount}} MDL",
    "decimal": 2
  },
  "MKD": {
    "currency": "MKD",
    "symbol": "ден",
    "moneyFormat": "ден {{amount}}",
    "decimal": 0
  },
  "MMK": {
    "currency": "MMK",
    "symbol": "K",
    "moneyFormat": "K{{amount}}",
    "decimal": 0
  },
  "MNT": {
    "currency": "MNT",
    "symbol": "₮",
    "moneyFormat": "{{amount_no_decimals}} ₮",
    "decimal": 0
  },
  "MOP": {
    "currency": "MOP",
    "symbol": "P",
    "moneyFormat": "MOP${{amount}}",
    "decimal": 2
  },
  "MUR": {
    "currency": "MUR",
    "symbol": "₨",
    "moneyFormat": "Rs {{amount}}",
    "decimal": 0
  },
  "MVR": {
    "currency": "MVR",
    "symbol": "MVR",
    "moneyFormat": "Rf{{amount}}",
    "decimal": 2
  },
  "MWK": {
    "currency": "MWK",
    "symbol": "MK",
    "moneyFormat": "MK {{amount}}",
    "decimal": 0
  },
  "MXN": {
    "currency": "MXN",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 2
  },
  "MYR": {
    "currency": "MYR",
    "symbol": "RM",
    "moneyFormat": "RM{{amount}}",
    "decimal": 2
  },
  "MZN": {
    "currency": "MZN",
    "symbol": "MTn",
    "moneyFormat": "{{amount}} Mt",
    "decimal": 0
  },
  "NAD": {
    "currency": "NAD",
    "symbol": "$",
    "moneyFormat": "N${{amount}}",
    "decimal": 2
  },
  "NGN": {
    "currency": "NGN",
    "symbol": "₦",
    "moneyFormat": "₦{{amount}}",
    "decimal": 0
  },
  "NIO": {
    "currency": "NIO",
    "symbol": "C$",
    "moneyFormat": "C${{amount}}",
    "decimal": 0
  },
  "NOK": {
    "currency": "NOK",
    "symbol": "kr",
    "moneyFormat": "kr {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "NPR": {
    "currency": "NPR",
    "symbol": "₨",
    "moneyFormat": "Rs{{amount}}",
    "decimal": 0
  },
  "NZD": {
    "currency": "NZD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "PAB": {
    "currency": "PAB",
    "symbol": "B/.",
    "moneyFormat": "PAB {{amount}}",
    "decimal": 2
  },
  "PEN": {
    "currency": "PEN",
    "symbol": "S/.",
    "moneyFormat": "S/. {{amount}}",
    "decimal": 2
  },
  "PGK": {
    "currency": "PGK",
    "symbol": "K",
    "moneyFormat": "K {{amount}}",
    "decimal": 2
  },
  "PHP": {
    "currency": "PHP",
    "symbol": "₱",
    "moneyFormat": "₱{{amount}}",
    "decimal": 0
  },
  "PKR": {
    "currency": "PKR",
    "symbol": "₨",
    "moneyFormat": "Rs.{{amount}}",
    "decimal": 0
  },
  "PLN": {
    "currency": "PLN",
    "symbol": "zł",
    "moneyFormat": "{{amount_with_comma_separator}} zl",
    "decimal": 2
  },
  "PYG": {
    "currency": "PYG",
    "symbol": "₲",
    "moneyFormat": "Gs. {{amount_no_decimals_with_comma_separator}}",
    "decimal": 0
  },
  "QAR": {
    "currency": "QAR",
    "symbol": "ر.ق",
    "moneyFormat": "QAR {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "RON": {
    "currency": "RON",
    "symbol": "Lei",
    "moneyFormat": "{{amount_with_comma_separator}} lei",
    "decimal": 2
  },
  "RSD": {
    "currency": "RSD",
    "symbol": "РСД",
    "moneyFormat": "{{amount}} RSD",
    "decimal": 0
  },
  "RUB": {
    "currency": "RUB",
    "symbol": "₽",
    "moneyFormat": "₽ {{amount_with_comma_separator}}",
    "decimal": 0
  },
  "RWF": {
    "currency": "RWF",
    "symbol": "FRw",
    "moneyFormat": "{{amount_no_decimals}} RF",
    "decimal": 0
  },
  "SAR": {
    "currency": "SAR",
    "symbol": "ر.س",
    "moneyFormat": "﷼‎{{amount}}",
    "decimal": 2
  },
  "SBD": {
    "currency": "SBD",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 2
  },
  "SCR": {
    "currency": "SCR",
    "symbol": "₨",
    "moneyFormat": "Rs {{amount}}",
    "decimal": 2
  },
  "SEK": {
    "currency": "SEK",
    "symbol": "kr",
    "moneyFormat": "{{amount_with_comma_separator}} kr",
    "decimal": 2
  },
  "SGD": {
    "currency": "SGD",
    "symbol": "$",
    "moneyFormat": "S${{amount}}",
    "decimal": 2
  },
  "SHP": {
    "currency": "SHP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}}",
    "decimal": 2
  },
  "SLL": {
    "currency": "SLL",
    "symbol": "Le",
    "moneyFormat": "Le {{amount}}",
    "decimal": 0
  },
  "SRD": {
    "currency": "SRD",
    "symbol": "$",
    "moneyFormat": "$ {{amount}}",
    "decimal": 2
  },
  "STD": {
    "currency": "STD",
    "symbol": "Db",
    "moneyFormat": "Db {{amount}}",
    "decimal": 0
  },
  "SZL": {
    "currency": "SZL",
    "symbol": "E",
    "moneyFormat": "L {{amount}}",
    "decimal": 2
  },
  "THB": {
    "currency": "THB",
    "symbol": "฿",
    "moneyFormat": "{{amount}} THB",
    "decimal": 0
  },
  "TJS": {
    "currency": "TJS",
    "symbol": "ЅМ",
    "moneyFormat": "TJS {{amount}}",
    "decimal": 2
  },
  "TOP": {
    "currency": "TOP",
    "symbol": "T$",
    "moneyFormat": "T$ {{amount}}",
    "decimal": 2
  },
  "TRY": {
    "currency": "TRY",
    "symbol": "₺",
    "moneyFormat": "{{amount}} TL",
    "decimal": 2
  },
  "TTD": {
    "currency": "TTD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "TWD": {
    "currency": "TWD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 0
  },
  "TZS": {
    "currency": "TZS",
    "symbol": "Sh",
    "moneyFormat": "{{amount}} TZS",
    "decimal": 0
  },
  "UAH": {
    "currency": "UAH",
    "symbol": "₴",
    "moneyFormat": "₴{{amount}}",
    "decimal": 0
  },
  "UGX": {
    "currency": "UGX",
    "symbol": "USh",
    "moneyFormat": "Ush {{amount_no_decimals}}",
    "decimal": 0
  },
  "USD": {
    "currency": "USD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "UYU": {
    "currency": "UYU",
    "symbol": "$",
    "moneyFormat": "${{amount_with_comma_separator}}",
    "decimal": 0
  },
  "UZS": {
    "currency": "UZS",
    "symbol": "",
    "moneyFormat": "лв {{amount}}",
    "decimal": 0
  },
  "VND": {
    "currency": "VND",
    "symbol": "₫",
    "moneyFormat": "{{amount_no_decimals_with_comma_separator}}₫",
    "decimal": 0
  },
  "VUV": {
    "currency": "VUV",
    "symbol": "Vt",
    "moneyFormat": "${{amount}}",
    "decimal": 0
  },
  "WST": {
    "currency": "WST",
    "symbol": "T",
    "moneyFormat": "WS$ {{amount}}",
    "decimal": 2
  },
  "XAF": {
    "currency": "XAF",
    "symbol": "Fr",
    "moneyFormat": "FCFA{{amount}}",
    "decimal": 0
  },
  "XCD": {
    "currency": "XCD",
    "symbol": "$",
    "moneyFormat": "${{amount}}",
    "decimal": 2
  },
  "XOF": {
    "currency": "XOF",
    "symbol": "Fr",
    "moneyFormat": "CFA{{amount}}",
    "decimal": 0
  },
  "XPF": {
    "currency": "XPF",
    "symbol": "Fr",
    "moneyFormat": "{{amount_no_decimals_with_comma_separator}} XPF",
    "decimal": 0
  },
  "YER": {
    "currency": "YER",
    "symbol": "﷼",
    "moneyFormat": "﷼ {{amount}}",
    "decimal": 0
  },
  "ZAR": {
    "currency": "ZAR",
    "symbol": "R",
    "moneyFormat": "R {{amount}}",
    "decimal": 2
  },
  "ZMW": {
    "currency": "ZMW",
    "symbol": "ZK",
    "moneyFormat": "K{{amount_no_decimals_with_comma_separator}}",
    "decimal": 2
  },
  "EEK": {
    "currency": "EEK",
    "symbol": "kr",
    "moneyFormat": "kr {{amount}} EEK",
    "decimal": 2
  },
  "LVL": {
    "currency": "LVL",
    "symbol": "Ls",
    "moneyFormat": "Ls {{amount}}",
    "decimal": 2
  },
  "LTL": {
    "currency": "LTL",
    "symbol": "Lt",
    "moneyFormat": "{{amount}} Lt",
    "decimal": 2
  },
  "SKK": {
    "currency": "SKK",
    "symbol": "Sk",
    "moneyFormat": "Sk {{amount}} SKK",
    "decimal": 2
  },
  "XPT": {
    "currency": "XPT",
    "symbol": "XPT",
    "moneyFormat": "{{amount}} XPT",
    "decimal": 2
  },
  "OMR": {
    "currency": "OMR",
    "symbol": "ر.ع.",
    "moneyFormat": "{{amount_with_comma_separator}} OMR",
    "decimal": 2
  },
  "SPL": {
    "currency": "SPL",
    "symbol": "SPL",
    "moneyFormat": "{{amount}} SPL",
    "decimal": 2
  },
  "ZWD": {
    "currency": "ZWD",
    "symbol": "Z$",
    "moneyFormat": "Z$ {{amount}}",
    "decimal": 0
  },
  "ERN": {
    "currency": "ERN",
    "symbol": "ناكفا",
    "moneyFormat": "ناكفا {{amount}}",
    "decimal": 2
  },
  "CUP": {
    "currency": "CUP",
    "symbol": "₱",
    "moneyFormat": "₱ {{amount}}",
    "decimal": 0
  },
  "BTN": {
    "currency": "BTN",
    "symbol": "Nu.",
    "moneyFormat": "Nu {{amount}} BTN",
    "decimal": 0
  },
  "XAG": {
    "currency": "XAG",
    "symbol": "Nu.",
    "moneyFormat": "{{amount}} XAG",
    "decimal": 2
  },
  "MGA": {
    "currency": "MGA",
    "symbol": "Ar",
    "moneyFormat": "Ar {{amount}} MGA",
    "decimal": 0
  },
  "TVD": {
    "currency": "TVD",
    "symbol": "TV$",
    "moneyFormat": "TV$ {{amount}} TVD",
    "decimal": 2
  },
  "GGP": {
    "currency": "GGP",
    "symbol": "GGP",
    "moneyFormat": "£ {{amount}} GGP",
    "decimal": 2
  },
  "XPD": {
    "currency": "XPD",
    "symbol": "XPD",
    "moneyFormat": "{{amount}} XPD",
    "decimal": 2
  },
  "JOD": {
    "currency": "JOD",
    "symbol": "د.ا ",
    "moneyFormat": "{{amount}} JOD",
    "decimal": 2
  },
  "VEF": {
    "currency": "VEF",
    "symbol": "Bs.",
    "moneyFormat": "Bs. {{amount_with_comma_separator}}",
    "decimal": 2
  },
  "TND": {
    "currency": "TND",
    "symbol": "د.ت",
    "moneyFormat": "{{amount}} د.ت",
    "decimal": 2
  },
  "IMP": {
    "currency": "IMP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}} IMP",
    "decimal": 2
  },
  "XDR": {
    "currency": "XDR",
    "symbol": "XDR",
    "moneyFormat": "{{amount}} XDR",
    "decimal": 2
  },
  "XAU": {
    "currency": "XAU",
    "symbol": "XAU",
    "moneyFormat": "{{amount}} XAU",
    "decimal": 2
  },
  "BHD": {
    "currency": "BHD",
    "symbol": ".د.ب",
    "moneyFormat": "{{amount}} .د.ب",
    "decimal": 2
  },
  "CUC": {
    "currency": "CUC",
    "symbol": "CUC$",
    "moneyFormat": "CUC$ {{amount}}",
    "decimal": 2
  },
  "KWD": {
    "currency": "KWD",
    "symbol": "د.ك",
    "moneyFormat": "{{amount}} د.ك",
    "decimal": 2
  },
  "BYN": {
    "currency": "BYN",
    "symbol": "Br",
    "moneyFormat": "Br {{amount}}",
    "decimal": 2
  },
  "SYP": {
    "currency": "SYP",
    "symbol": "£S",
    "moneyFormat": "£S {{amount}}",
    "decimal": 0
  },
  "KPW": {
    "currency": "KPW",
    "symbol": "₩",
    "moneyFormat": "₩ {{amount}}",
    "decimal": 0
  },
  "JEP": {
    "currency": "JEP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}} JEP",
    "decimal": 2
  },
  "IRR": {
    "currency": "IRR",
    "symbol": "﷼",
    "moneyFormat": "{{amount}} ﷼",
    "decimal": 0
  },
  "LYD": {
    "currency": "LYD",
    "symbol": "ل.د",
    "moneyFormat": "LYD {{amount}} ل.د",
    "decimal": 2
  },
  "MRU": {
    "currency": "MRU",
    "symbol": "UM",
    "moneyFormat": "UM {{amount}}",
    "decimal": 0
  },
  "MRO": {
    "currency": "MRO",
    "symbol": "UM",
    "moneyFormat": "UM {{amount}}",
    "decimal": 0
  },
  "SDG": {
    "currency": "SDG",
    "symbol": "£SD",
    "moneyFormat": "£SD {{amount}}",
    "decimal": 0
  },
  "TMT": {
    "currency": "TMT",
    "symbol": "T",
    "moneyFormat": "T {{amount}} TMT",
    "decimal": 2
  },
  "IQD": {
    "currency": "IQD",
    "symbol": "T",
    "moneyFormat": "{{amount}} ع.د",
    "decimal": 0
  },
  "SOS": {
    "currency": "SOS",
    "symbol": "Sh.so.",
    "moneyFormat": "Sh.so.{{amount}}",
    "decimal": 0
  },
  "SVC": {
    "currency": "SVC",
    "symbol": "SVC",
    "moneyFormat": "{{amount}} SVC",
    "decimal": 2
  },
  "GHS": {
    "currency": "GHS",
    "symbol": "GH₵",
    "moneyFormat": "GH₵ {{amount}}",
    "decimal": 2
  },
  "CYP": {
    "currency": "CYP",
    "symbol": "£",
    "moneyFormat": "£ {{amount}} CYP",
    "decimal": 2
  },
  "MTL": {
    "currency": "MTL",
    "symbol": "Lm",
    "moneyFormat": "Lm {{amount}} MTL",
    "decimal": 2
  },
  "SIT": {
    "currency": "SIT",
    "symbol": "SIT",
    "moneyFormat": "{{amount}} SIT",
    "decimal": 2
  },
  "VEB": {
    "currency": "VEB",
    "symbol": "Bs",
    "moneyFormat": "Bs {{amount}} VEB",
    "decimal": 0
  },
  "BYR": {
    "currency": "BYR",
    "symbol": "BYR",
    "moneyFormat": "{{amount}} BYR",
    "decimal": 0
  },
  "TMM": {
    "currency": "TMM",
    "symbol": "TMM",
    "moneyFormat": "{{amount}} TMM",
    "decimal": 0
  },
  "ZMK": {
    "currency": "ZMK",
    "symbol": "ZMK",
    "moneyFormat": "{{amount}} ZMK",
    "decimal": 0
  },
  "XBT": {
    "currency": "XBT",
    "symbol": "XBT",
    "moneyFormat": "{{amount}} XBT",
    "decimal": 2
  },
  "NTD": {
    "currency": "NTD",
    "symbol": "NTD",
    "moneyFormat": "{{amount}} NTD",
    "decimal": 0
  },
  "CNH": {
    "currency": "CNH",
    "symbol": "CNH",
    "moneyFormat": "{{amount}} CNH",
    "decimal": 2
  },
  "STN": {
    "currency": "STN",
    "symbol": "STN",
    "moneyFormat": "{{amount}} STN",
    "decimal": 2
  },
  "VES": {
    "currency": "VES",
    "symbol": "VES",
    "moneyFormat": "{{amount}} VES",
    "decimal": 0
  },
  "MXV": {
    "currency": "MXV",
    "symbol": "MXV",
    "moneyFormat": "{{amount}} MXV",
    "decimal": 2
  }
};

// var wsscc_rates = {
//   "USD": 1,
//   "EUR": 1.20776,
//   "GBP": 1.35811,
//   "CAD": 0.784335,
//   "ARS": 0.0116181,
//   "AUD": 0.768485,
//   "BRL": 0.188814,
//   "CLP": 0.00136235,
//   "CNY": 0.154067,
//   "CYP": 0.397899,
//   "CZK": 0.0461995,
//   "DKK": 0.162349,
//   "EEK": 0.0706676,
//   "HKD": 0.128976,
//   "HUF": 0.00335942,
//   "ISK": 0.00771035,
//   "INR": 0.0136641,
//   "JMD": 0.00689992,
//   "JPY": 0.00964225,
//   "LVL": 1.57329,
//   "LTL": 0.320236,
//   "MTL": 0.293496,
//   "MXN": 0.0507698,
//   "NZD": 0.711518,
//   "NOK": 0.116346,
//   "PLN": 0.266398,
//   "SGD": 0.751479,
//   "SKK": 21.5517,
//   "SIT": 175.439,
//   "ZAR": 0.0659438,
//   "KRW": 0.000905768,
//   "SEK": 0.119108,
//   "CHF": 1.12238,
//   "TWD": 0.0357251,
//   "UYU": 0.023601,
//   "MYR": 0.246998,
//   "BSD": 1,
//   "CRC": 0.00163219,
//   "RON": 0.247816,
//   "PHP": 0.0208025,
//   "AED": 0.272294,
//   "VEB": 0.000100125,
//   "IDR": 0.0000710575,
//   "TRY": 0.133587,
//   "THB": 0.0332053,
//   "TTD": 0.147352,
//   "ILS": 0.309242,
//   "SYP": 0.0019501,
//   "XCD": 0.370058,
//   "COP": 0.00028752,
//   "RUB": 0.0135215,
//   "HRK": 0.159889,
//   "KZT": 0.00237641,
//   "TZS": 0.000431241,
//   "XPT": 1086.63,
//   "SAR": 0.266667,
//   "NIO": 0.028594,
//   "LAK": 0.00010714,
//   "OMR": 2.60078,
//   "AMD": 0.00191401,
//   "CDF": 0.000507389,
//   "KPW": 0.00111104,
//   "SPL": 6,
//   "KES": 0.00908142,
//   "ZWD": 0.00276319,
//   "KHR": 0.000245829,
//   "MVR": 0.0651685,
//   "GTQ": 0.128079,
//   "BZD": 0.495224,
//   "BYR": 0.0000391604,
//   "LYD": 0.223777,
//   "DZD": 0.0075152,
//   "BIF": 0.000513676,
//   "GIP": 1.35811,
//   "BOB": 0.145127,
//   "XOF": 0.00184121,
//   "STD": 0.000049293,
//   "NGN": 0.00252413,
//   "PGK": 0.285,
//   "ERN": 0.0666667,
//   "MWK": 0.00129717,
//   "CUP": 0.0377358,
//   "GMD": 0.0193073,
//   "CVE": 0.0109527,
//   "BTN": 0.0136641,
//   "XAF": 0.00184121,
//   "UGX": 0.000271001,
//   "MAD": 0.111728,
//   "MNT": 0.00034982,
//   "LSL": 0.0659438,
//   "XAG": 25.0409,
//   "TOP": 0.437588,
//   "SHP": 1.35811,
//   "RSD": 0.0102719,
//   "HTG": 0.0134309,
//   "MGA": 0.000263479,
//   "MZN": 0.0133284,
//   "FKP": 1.35811,
//   "BWP": 0.0903929,
//   "HNL": 0.0413788,
//   "PYG": 0.000145152,
//   "JEP": 1.35811,
//   "EGP": 0.0637099,
//   "LBP": 0.00066335,
//   "ANG": 0.558857,
//   "WST": 0.394471,
//   "TVD": 0.768485,
//   "GYD": 0.00475983,
//   "GGP": 1.35811,
//   "NPR": 0.00850022,
//   "KMF": 0.00245495,
//   "IRR": 0.0000238543,
//   "XPD": 2376.82,
//   "SRD": 0.0707175,
//   "TMM": 0.0000571429,
//   "SZL": 0.0659438,
//   "MOP": 0.12522,
//   "BMD": 1,
//   "XPF": 0.010121,
//   "ETB": 0.0252899,
//   "JOD": 1.41044,
//   "MDL": 0.0576913,
//   "MRO": 0.00273432,
//   "YER": 0.00400541,
//   "BAM": 0.617516,
//   "AWG": 0.558659,
//   "PEN": 0.276819,
//   "VEF": 0.100125,
//   "SLL": 0.0000988213,
//   "KYD": 1.21951,
//   "AOA": 0.00152497,
//   "TND": 0.370681,
//   "TJS": 0.0884957,
//   "SCR": 0.0471486,
//   "LKR": 0.00518972,
//   "DJF": 0.00562377,
//   "GNF": 0.000097619,
//   "VUV": 0.0092077,
//   "SDG": 0.0180894,
//   "IMP": 1.35811,
//   "GEL": 0.303464,
//   "FJD": 0.48946,
//   "DOP": 0.0171389,
//   "XDR": 1.43761,
//   "MUR": 0.0252754,
//   "MMK": 0.000750348,
//   "LRD": 0.00594374,
//   "BBD": 0.5,
//   "ZMK": 0.0000468677,
//   "XAU": 1837.31,
//   "VND": 0.0000433379,
//   "UAH": 0.0354496,
//   "TMT": 0.285714,
//   "IQD": 0.000683227,
//   "BGN": 0.617516,
//   "KGS": 0.0118352,
//   "RWF": 0.00101071,
//   "BHD": 2.65957,
//   "UZS": 0.0000952645,
//   "PKR": 0.0062287,
//   "MKD": 0.0195715,
//   "AFN": 0.0129312,
//   "NAD": 0.0659438,
//   "BDT": 0.0117768,
//   "AZN": 0.588564,
//   "SOS": 0.00172826,
//   "QAR": 0.274725,
//   "PAB": 1,
//   "CUC": 1,
//   "SVC": 0.114286,
//   "SBD": 0.12445,
//   "ALL": 0.00979163,
//   "BND": 0.751479,
//   "KWD": 3.29516,
//   "GHS": 0.171609,
//   "ZMW": 0.0468677,
//   "XBT": 37184.6,
//   "NTD": 0.0337206,
//   "BYN": 0.391604,
//   "CNH": 0.153956,
//   "MRU": 0.0273432,
//   "STN": 0.049293,
//   "VES": 6.4678e-7,
//   "MXV": 0.328986
// };
// var shopifyCurrency = window.Shopify && window.Shopify.currency && window.Shopify.currency.active ? window.Shopify.currency.active : "";

// // webrexteststore's selectors
// var countries = [
//   {
//     "autoCurrencyConvert": false,
//     "countryName": "France",
//     "countryCode": "FR",
//     "countryCurrency": "EUR",
//     "currencySymbol": "€",
//     "percentage": 10,
//     "configuration": { "manualExchange": false, "manualExchangeRate": "1", "shopifyCurrency": true },
//     "currency": "EUR",
//     "priceType": "percentage",
//     "priceValue": 0,
//     "symbol": "€"
//   },
//   {
//     "default": true,
//     "autoCurrencyConvert": false, "countryCode": "IN", "currency": "INR", "symbol": "₹", "priceType": "amount", "priceValue": 0, "configuration": { "manualExchange": false, "shopifyCurrency": true }
//   }, { "autoCurrencyConvert": true, "countryCode": "ROW", "currency": "ACS", "symbol": "₹", "priceType": "amount", "priceValue": 0, "configuration": { "manualExchange": false, "shopifyCurrency": false } }, { "autoCurrencyConvert": true, "countryCode": "CAS", "configuration": { "manualExchange": false, "manualExchangeRate": "1", "shopifyCurrency": false }, "currency": "ACS", "priceType": "percentage", "priceValue": 10, "symbol": "$" }, { "autoCurrencyConvert": false, "countryCode": "CSA", "configuration": { "manualExchange": false, "manualExchangeRate": "1", "shopifyCurrency": false }, "currency": "USD", "priceType": "percentage", "priceValue": 20, "symbol": "$" }, { "autoCurrencyConvert": false, "countryCode": "US", "configuration": { "manualExchange": false, "manualExchangeRate": "1", "shopifyCurrency": false }, "currency": "USD", "priceType": "percentage", "priceValue": -30, "symbol": "$" }];
// var prbc_selectors = [{ "pages": ["home", "collection", "search"], "repeated": false, "type": "productList", "selector": ".grid-uniform .grid__item", "priceSelector": "p.grid-link__meta", "linkSelector": ".grid-link", "initialTime": 0, "repeatedTime": 0 }, { "pages": ["product"], "repeated": false, "type": "productDetail", "selector": ".product-single", "priceSelector": ".product-single__prices", "variantSelector": ".selector-wrapper", "initialTime": 0, "repeatedTime": 0 }];
// var generalCurrencySetting = { "configuration": { "moneyFormat": true, "moneyFormatObj": { "moneyFormat": "smart" } } };
// var currencySetting = [];
// var defaultCurrency = { "currency": "INR" };
// var pricingPlan = "Pricing By Country";

// var countries = [{ "autoCurrencyConvert": false, "default": true, "countryCode": "TR", "currency": "TRY", "symbol": "TL", "priceType": "amount", "priceValue": 0, "configuration": { "manualExchange": false, "shopifyCurrency": true } }, { "autoCurrencyConvert": false, "default": false, "countryCode": "ROW", "currency": "USD", "symbol": "$", "priceType": "amount", "priceValue": 1, "configuration": { "manualExchange": false, "manualExchangeRate": "1", "shopifyCurrency": false } }];
// var prbc_selectors = [
//   {
//     "pages": ["home", "collection", "search"], "repeated": false, "type": "productList", "selector": ".product-inner .product-info", "priceSelector": ".price", "linkSelector": ".product-title a", "variantSelector": "", "siblingSelector": "", "initialTime": 0, "repeatedTime": 0
//   },
//   {
//     "pages": ["product"], "repeated": false, "type": "productList", "selector": ".product-inner .product-info", "priceSelector": ".price", "linkSelector": ".product-title a", "variantSelector": "", "siblingSelector": "", "initialTime": 2000, "repeatedTime": 0
//   },
//   {
//     "pages": ["product"], "repeated": false, "type": "productDetail", "selector": ".summary", "priceSelector": ".price_range", "linkSelector": null, "variantSelector": ".variations", "siblingSelector": null, "initialTime": 2000, "repeatedTime": 0
//   }
// ];
// var generalCurrencySetting = { "configuration": { "moneyFormat": true, "moneyFormatObj": { "moneyFormat": "smart" } } };
// var currencySetting = [];
// var defaultCurrency = { "currency": "TRY" };
// var pricingPlan = "Pricing By Country";

var countries = {c:"countries"};
var prbc_selectors = {s:"prbc_selectors"};
var wsscc_rates = {l:"liveCurrencyRates"};
var defaultCurrency = {d:"defaultCurrency"};
var generalCurrencySetting = {g:"generalCurrencySetting"};
var currencySetting = {cs:"currencySetting"};
var pricingPlan = {p:"pricingPlan"};
var shopifyCurrency = {sc:"shopifyCurrency"};

// var countries=[{"autoCurrencyConvert":false,"default":true,"countryCode":"US","currency":"USD","symbol":"$","priceType":"amount","priceValue":0,"configuration":{"manualExchange":false,"shopifyCurrency":true}},{"autoCurrencyConvert":true,"default":false,"countryCode":"ROW","currency":"ACS","symbol":"$","priceType":"amount","priceValue":0,"configuration":{"manualExchange":false,"shopifyCurrency":false}},{"autoCurrencyConvert":false,"default":false,"countryCode":"DE","configuration":{"manualExchange":false,"manualExchangeRate":"1","shopifyCurrency":false},"currency":"EUR","priceType":"percentage","priceValue":0,"symbol":"€"}]; 
//  var prbc_selectors =[{"pages":["home","collection","search"],"repeated":false,"type":"productList","selector":".product-collection","priceSelector":".product-collection__price","linkSelector":".product-collection__title a","initialTime":0,"repeatedTime":0},{"pages":["product"],"repeated":false,"type":"productDetail","selector":".product-page-main","priceSelector":".product-page-info__price","variantSelector":".product-options__section","initialTime":1000,"repeatedTime":0}]; 
//  var generalCurrencySetting ={"configuration":{"moneyFormat":true,"moneyFormatObj":{"moneyFormat":"smart"}}}; 
//  var currencySetting =[]; 
//  var defaultCurrency ={"currency":"USD"}; 
//  var pricingPlan ="Pricing By Country"

var userId;
var apiUrl = "https://pricing-by-country-api.webrexstudio.com/";
// var apiUrl = "http://localhost:3000/";

var ipCountryData;
var userCountry;
var userCountryCode;
var currentPage;
var findCountry;

var conversionFee = [
  { countryCode: "JPY", fees: 2 },
  { countryCode: "GB", fees: 1.75 },
  { countryCode: "IE", fees: 1.75 },
  { countryCode: "ES", fees: 1.75 },
  { countryCode: "DE", fees: 1.75 }
];
var countrySetting;

var defaultCountry = countries.find(e => e.default == true);

var Shopify = Shopify || {};
Shopify.formatMoney = function (cents, format) {
  if (typeof cents == 'string') { cents = cents.replace('.', ''); }
  var value = '';
  var placeholderRegex = /\{\{\s*(\w+)\s*\}\}/;
  var formatString = (format || this.money_format);

  function defaultOption(opt, def) {
    return (typeof opt == 'undefined' ? def : opt);
  }

  function formatWithDelimiters(number, precision, thousands, decimal) {
    precision = defaultOption(precision, 2);
    thousands = defaultOption(thousands, ',');
    decimal = defaultOption(decimal, '.');

    if (isNaN(number) || number == null) { return 0; }

    number = (number / 100.0).toFixed(precision);

    var parts = number.split('.'),
      dollars = parts[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1' + thousands),
      cents = parts[1] ? (decimal + parts[1]) : '';

    return dollars + cents;
  }

  switch (formatString.match(placeholderRegex)[1]) {
    case 'amount':
      value = formatWithDelimiters(cents, 2);
      break;
    case 'amount_no_decimals':
      value = formatWithDelimiters(cents, 0);
      break;
    case 'amount_with_comma_separator':
      value = formatWithDelimiters(cents, 2, '.', ',');
      break;
    case 'amount_no_decimals_with_comma_separator':
      value = formatWithDelimiters(cents, 0, '.', ',');
      break;
  }

  return formatString.replace(placeholderRegex, value);
};

var pageSelectors;

var testbarCss = `.prbc-test-div {
  position: fixed;
  bottom: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #000;
  padding: 10px;
  color: #fff;
  right: 20px;
  z-index: 9999;
  background: #717171;
  padding: 40px 20px 20px 20px;
  border-radius: 10px;
  min-width: 320px;
  flex-direction: column;
  padding-bottom: 50px;
  padding-top: 60px;
  overflow: hidden;
}


.prbc-test-div span.prbc-title-span{
  box-shadow: 0px 1px 3px 0px #0000006b;
  font-weight: bold;
  position: absolute;
  top: 0;
  left: 0;
  margin: 0px;
  width: 100%;
  background: #555;
  padding: 10px;
}

.prbc-test-div select {
  margin: 0px;
  margin-bottom: 10px;
  width: 100%;
  color: #000;
  padding: 10px;
  border-radius: 3px;
  border: none;
  background:#fff;
}
span.testClose{
  position: absolute;
  top: 14px;
  right: 10px;
  width: 18px;
  left: initial;
  font-family: sans-serif;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-weight: bold;
  font-size: 26px;
  transform: rotate(45deg);
}

.prbc-test-div .prbc-btn{
  margin-left: 10px;
  margin: 0;
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  border-radius: 0px 0px 10px 10px;
  box-shadow: 0px -1px 3px 0px #0000006b;
  border: none;
  padding: 8px 10px;
  background: #59756f;
  color: #fff;
  font-size: 16px;
  font-family: sans-serif;
  letter-spacing: 1px;
  outline:none;
}
.prbc-not-country .prbc-row-selected{
  display:none;
}
.prbc-not-country .prbc-continent-selected{
  display:none;
}
.prbc-not-country .prbc-row-selected.active{
  display:block;
}
.prbc-not-country .prbc-continent-selected.active{
  display:block;
}

.prbc-not-country{
  width:100%;
}

.prbc-not-country input{
  width: 100%;
  color: #000;
  padding: 10px;
  border-radius: 3px;
  background: #fff;
  border: none;
}`;
let testRow = false;
let testContinent = false;
let tmpVariant;

async function testCountry() {
  let tmpCountryCode = document.getElementById("testCountrySelect").value;
  localStorage.setItem("prbcTestCountry", tmpCountryCode);

  if (testRow || testContinent) {
    if (testRow) {
      let val = document.getElementById("prbcRowCountry").value;
      localStorage.setItem("prbcRowCountry", val.toUpperCase());
      localStorage.removeItem("prbcContinentCurrency");
    } else if (testContinent) {
      let val = document.getElementById("prbcContinentCurrency").value;
      localStorage.setItem("prbcContinentCurrency", val.toUpperCase());
      localStorage.removeItem("prbcRowCountry");
    }
  } else {
    localStorage.removeItem("prbcContinentCurrency");
    localStorage.removeItem("prbcRowCountry");
  }

  if (shopifyCurrency != defaultCurrency.currency) {
    await priceByCountry.localization(defaultCurrency.currency)
  }
  window.location.replace(window.location.href);
}

function closeTestCountry() {
  localStorage.removeItem("prbcRowCountry");
  localStorage.removeItem("prbcTestCountry");
  localStorage.removeItem("prbcContinentCurrency");
  window.location.replace(window.location.href.split("?")[0]);
}

function addRowCountryInput() {
  testRow = true;
  testContinent = false;
  let continentInputDiv = document.getElementById("prbcContinentSelected");
  if (continentInputDiv) {
    continentInputDiv.classList.remove("active");
  }
  let rowInputDiv = document.getElementById("prbcRowSelected");
  if (rowInputDiv) {
    rowInputDiv.classList.add("active");
    document.getElementById("prbcRowCountry").value = localStorage.getItem("prbcRowCountry");
  }
}

function addCountinentCurrencyInput(val) {
  testContinent = true;
  testRow = false;
  let rowInputDiv = document.getElementById("prbcRowSelected");
  rowInputDiv.classList.remove("active");
  let continentInputDiv = document.getElementById("prbcContinentSelected");
  let continentData = countries.find(e => e.countryCode == val);
  if (continentData && !continentData.autoCurrencyConvert) {
    continentInputDiv.classList.remove("active");
    document.getElementById("prbcContinentCurrency").value = continentData.currency;
  } else {
    continentInputDiv.classList.add("active");
    document.getElementById("prbcContinentCurrency").value = localStorage.getItem("prbcContinentCurrency");
  }
}

function createTestCurrencySelect() {
  let val = document.getElementById("testCountrySelect").value;
  if (val.length == 3) {
    if (val == "ROW") {
      addRowCountryInput();
    } else {
      addCountinentCurrencyInput(val);
    }
  } else {

    let continentInputDiv = document.getElementById("prbcContinentSelected");
    if (continentInputDiv) {
      continentInputDiv.classList.remove("active");
    }
    let rowInputDiv = document.getElementById("prbcRowSelected");
    if (rowInputDiv) {
      rowInputDiv.classList.remove("active");
    }
  }
}

function setTestBar() {
  priceByCountry.prbcAddCss(testbarCss);
  let prbcTestDiv = document.createElement("div");
  prbcTestDiv.classList.add("prbc-test-div");
  let testSelect = document.createElement("select");
  testSelect.setAttribute("id", "testCountrySelect");
  testSelect.addEventListener('change', function () { createTestCurrencySelect() });

  let testTitle = document.createElement("span");
  testTitle.innerText = "Pricing By Country Testing";
  testTitle.classList.add("prbc-title-span");

  let testSelectLable = document.createElement("span");
  testSelectLable.style.width = "100%";
  testSelectLable.innerText = 'Select location to check';

  let testClose = document.createElement("span");
  testClose.classList.add("testClose");
  testClose.addEventListener('click', function () { closeTestCountry() });
  testClose.innerText = "+";

  let testButton = document.createElement("Button");
  testButton.classList.add("prbc-btn");
  testButton.innerText = "Test";

  let testNotCountryDiv = document.createElement("div");
  testNotCountryDiv.classList.add("prbc-not-country");
  testNotCountryDiv.innerHTML = `  <div class="prbc-row-selected prbc-ig" id="prbcRowSelected">
    <label>Country code</label>
    <input placeholder='e.g. US' type="text" id="prbcRowCountry">
  </div>
  <div class="prbc-continent-selected prbc-ig" id="prbcContinentSelected">
    <label>Currency Code</label>
    <input placeholder='e.g. USD' type="text" id="prbcContinentCurrency">
  </div>`;

  testButton.addEventListener('click', function () { testCountry() });
  for (let i = 0; i < countries.length; i++) {
    let testCountry = countries[i];
    let testOption = document.createElement("option");
    testOption.innerText = testCountry.countryCode +
      (testCountry.countryCode.length < 3
        ? " - " + testCountry.currency + "(" + testCountry.symbol + ")"
        : (!testCountry.autoCurrencyConvert ? " - " + testCountry.currency + "(" + testCountry.symbol + ")" : '')
      );
    testOption.setAttribute("value", testCountry.countryCode);
    testSelect.appendChild(testOption);
  }

  prbcTestDiv.innerHTML = "";
  prbcTestDiv.append(testTitle);
  prbcTestDiv.append(testSelectLable);
  prbcTestDiv.append(testSelect);
  prbcTestDiv.append(testNotCountryDiv);
  prbcTestDiv.append(testButton);
  prbcTestDiv.append(testClose);

  document.getElementsByTagName('body')[0].append(prbcTestDiv);

}

async function getAndSetAdminTestData() {
  if (localStorage.getItem("prbcTestCountry")) {
    let testCountryCode = localStorage.getItem("prbcTestCountry");
    document.getElementById("testCountrySelect").value = testCountryCode;
    let post = {};
    if (testCountryCode.length == 3) {
      createTestCurrencySelect();
      let prbcContinentCurrency = localStorage.getItem("prbcContinentCurrency");
      let prbcRowCountry = localStorage.getItem("prbcRowCountry");
      if (prbcRowCountry) {
        let countryData = await fetch(apiUrl + "getCountry?countryCode=" + prbcRowCountry);
        post = (await countryData.json())['data'];
      } else if (prbcContinentCurrency) {
        post.countryCode = testCountryCode;
        post.continentCode = testCountryCode.replace("C", "");
        post.currency = prbcContinentCurrency;
      }
    } else {
      localStorage.removeItem("prbcRowCountry");
      localStorage.removeItem("prbcContinentCurrency");
      let countryData = await fetch(apiUrl + "getCountry?countryCode=" + localStorage.getItem("prbcTestCountry"));
      post = (await countryData.json())['data'];
    }
    priceByCountry.handlePage(post);
  } else {
    localStorage.setItem("prbcTestCountry", defaultCountry.countryCode);
    document.getElementById("testCountrySelect").value = defaultCountry.countryCode;
    priceByCountry.handlePage({ ...defaultCountry, ...{ continentCode: "" } });
  }
}

function autoUpdate(page, inital, reapea) {
  setTimeout(() => {
    setInterval(() => {
      setPrice(page, defaultCountry);
    }, 1000);
  }, 5000);
}

document.addEventListener("DOMSubtreeModified", function () {
  let eventBindElemets = [
    { selector: "body form[action^='/cart'] input", eventType: "onchange" },
    { selector: "body form[action^='/cart'] select", eventType: "onchange" },
    { selector: "body form[action^='/cart'] button[type='submit']", eventType: "onclick" },
    { selector: "body form[action^='/cart'] button[type='button']", eventType: "onclick" },
    { selector: "body a[href*='/cart']", eventType: "onclick" }
  ];
  for (let i = 0; i < eventBindElemets.length; i++) {
    let eArr = eventBindElemets[i]['selector'];
    let eventType = eventBindElemets[i]['eventType'];
    let singleElement = document.querySelectorAll(eArr);
    if (singleElement.length > 0) {
      for (let j = 0; j < singleElement.length; j++) {
        let element = singleElement[j];
        wssccBindEvent(element, "product", eventType);
      }
    }
  }
});

function updateProductPagePrices(page) {
  try {
    setTimeout(() => {
      setPrice(page, defaultCountry);
    }, 500);
  } catch (error) {
    makeDefaultVisible();
  }
}

function wssccBindEvent(element, page, eventType) {
  if (!element["changeEventaddedd"]) {
    element["changeEventaddedd"] = true;
    element.addEventListener('change', () => { updateProductPagePrices(page) });
  }
}

const priceByCountry = {
  getDivisionValue: function (value) {
    try {
      let num = "1";
      for (let i = 0; i < value; i++) {
        num += "0";
      }
      return num;
    } catch (error) {
      throw error
    }
  },
  getPrice: function (element) {
    try {
      let amountStr = element.innerHTML.replace(/[^\d.,'-]/g, "");
      let amount = amountStr.split(/[\,.']+/);
      let finalAmount;
      if (amount.length > 1) {
        if (amount[amount.length - 1].length == 2) {
          finalAmount = parseFloat(amountStr.replace(/[^\d]/g, "")) / 100;
        } else {
          let divisionVal = parseInt(priceByCountry.getDivisionValue(amount[amount.length - 1].length));
          finalAmount = parseFloat(amountStr.replace(/[^\d]/g, "")) / divisionVal;
        }
      } else {
        finalAmount = parseFloat(amountStr.replace(/[^\d]/g, ""));
      }
      return finalAmount;
    } catch (error) {
      throw error;
    }
  },
  findPage: function () {
    try {
      let page;
      let winHref = window.location.href;
      if (winHref.indexOf('/products/') > -1) {
        page = 'product';
      } else if (winHref.indexOf('/collections') > -1) {
        page = 'collection';
      } else if (winHref.indexOf('/cart') > -1) {
        page = 'cart';
      } else {
        page = 'home';
      }
      return page;
    } catch (error) {
      throw error;
    }
  },
  findSelectors: function (page) {
    try {
      return prbc_selectors.filter(e => e.pages.includes(page));
    } catch (error) {
      throw error;
    }
  },
  setCookie: function (name, value, days) {
    try {
      var expires = "";
      if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";

    } catch (error) {
      throw error;
    }
  },
  deleteCookie(name) {
    document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
  },
  setCartCurrency: function () {
    try {
      if (pricingPlan == "Premium100" || pricingPlan == "Pricing By Country") {
        if (userCountry.isROW) {
          findCountry = countries.find(e => e.countryCode.toUpperCase() == "ROW");
        } else {
          findCountry = countries.find(e => e.countryCode.toUpperCase() == userCountry.countryCode.toUpperCase());
        }

        if (findCountry && findCountry.configuration.shopifyCurrency && shopifyCurrency != findCountry.currency) {
          var http = new XMLHttpRequest();
          http.open("POST", "/localization", true);
          http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
          var params = "_method=PUT&currency_code=" + findCountry.currency;
          http.send(params);
          http.onload = function () { }
        }
      }
    } catch (error) {
      throw error;
    }
  },
  localization: async function (currency) {
    var params = "_method=PUT&currency_code=" + currency;
    await fetchPostAsync("POST", "/localization", params);
  },
  setCountry: function (data) {
    try {
      let continent = "C" + data.continentCode;
      let crnByCrn, crnByCountry, tmpCountry;
      tmpCountry = countries.find(e => e.countryCode == data.countryCode);
      if (!tmpCountry) tmpCountry = countries.find(e => e.countryCode == continent);
      tmpCountry = tmpCountry ? tmpCountry : countries.find(e => e.countryCode == "ROW");
      if (tmpCountry) {
        if (tmpCountry.countryCode == "ROW" && tmpCountry.autoCurrencyConvert) {
          crnByCountry = { ...tmpCountry, "countryCode": data.countryCode, ...currencyObject[data.currency], "isROW": true };
        } else if (tmpCountry.countryCode == "ROW" && !tmpCountry.autoCurrencyConvert) {
          crnByCountry = { ...tmpCountry, "countryCode": data.countryCode, ...currencyObject[tmpCountry.currency], "isROW": true };
        } else if (tmpCountry.countryCode == continent && tmpCountry.autoCurrencyConvert) {
          crnByCountry = { ...tmpCountry, "countryCode": continent, ...currencyObject[data.currency], "isROW": true };
        } else if (tmpCountry.countryCode == continent && !tmpCountry.autoCurrencyConvert) {
          crnByCountry = { ...tmpCountry, "countryCode": continent, ...currencyObject[tmpCountry.currency], "isROW": true };
        } else {
          crnByCountry = { ...tmpCountry, ...currencyObject[tmpCountry.currency] };
        }
      } else {
        if (pricingPlan != "Premium100" || pricingPlan != "Pricing By Country") {
          crnByCountry = currencyObject[data.currency];
        }
      }

      crnByCrn = currencySetting.find(e => {
        if (e.configuration.currencies.find(c => { return c.code == data.currency })) {
          e.configuration.currency = e.configuration.currencies.find(c => { return c.code == data.currency });
          return true
        } else {
          return false;
        }
      });

      configuration = { ...generalCurrencySetting.configuration, ...(crnByCrn && crnByCrn.configuration ? crnByCrn.configuration : {}), ...(crnByCountry && crnByCountry.configuration ? crnByCountry.configuration : {}) }

      userCountry = { ...generalCurrencySetting, ...crnByCrn, ...crnByCountry, configuration: configuration, ...configuration.currency };

      userCountry.moneyFormat = userCountry.configuration.moneyFormatObj && userCountry.configuration.moneyFormatObj.moneyFormat == 'strict' ? userCountry.configuration.moneyFormatObj.moneyFormatRule : userCountry.moneyFormat;

      if (userCountry.configuration.moneyFormatObj && userCountry.configuration.moneyFormatObj.moneyFormat == 'strict') {
        userCountry.moneyFormat = userCountry.moneyFormat.replace("Symbol", userCountry.symbol);
        userCountry.moneyFormat = userCountry.moneyFormat.replace("Currency", userCountry.currency);
      }

      defaultCountry = { ...defaultCountry, ...defaultCurrency };
      countrySetting = { userCountry: userCountry, defaultCountry: defaultCountry };
      priceByCountry.setCartCurrency();

    } catch (error) {
      throw error;
    }
  },
  manageCollection: function (selector, type) {
    try {
      let collections = document.querySelectorAll(selector.selector);
      collections.forEach((collection) => {
        if (collection.querySelector(selector.priceSelector)) {
          if (type == "convert") {
            this.findMoneyElement(
              'collection',
              collection.querySelector(selector.priceSelector),
              defaultCountry,
              userCountry
            );
          } else if (type == "visible") {
            collection.querySelector(selector.priceSelector).style.visibility = "visible";
          }
        }
      });
    } catch (error) {
      throw error;
    }
  },
  getRoundAmount: function (round, base, amount) {
    try {
      let reminder = amount % base;
      let value = parseInt(amount / base) * base;
      if (reminder > round) {
        return value + base + round;
      } else {
        if (round == base && reminder == 0) {
          return value;
        } else {
          return value + round;
        }
      }
    } catch (error) {
      throw error;
    }
  },
  getRoundAmountNew: function (to, amount) {
    try {
      let roundingObj = to.configuration.priceRoundingObj;
      let round, base;
      if (!roundingObj.roundingRule) {
        if (to.decimal == 0) {
          round = parseFloat(roundingObj.roundingRuleBase100);
          base = 100;
        } else if (to.decimal > 0) {
          round = parseFloat(roundingObj.roundingRuleBase1);
          base = 1;
        }
      } else {
        round = parseFloat(roundingObj.roundingRule);
        base = roundingObj.roundingRule <= 1 ? 1 : 100;
      }
      let reminder = (amount % base).toFixed(2);
      let value = parseInt(amount / base) * base;
      if (reminder > round) {
        return value + base + round;
      } else {
        if (round == base && reminder == 0) {
          return value;
        } else {
          return value + round;
        }
      }
    } catch (error) {
      throw error;
    }
  },
  getConvertedElement: function (from, to, amount) {
    try {
      let elementPrice = to.configuration.manualExchange === true ? parseFloat(amount) * to.configuration.manualExchangeRate : (parseFloat(amount) * wsscc_rates[from.currency]) / wsscc_rates[to.currency];
      if (from.currency != to.currency) {
        if (findCountry && findCountry.configuration.shopifyCurrency && !findCountry.configuration.manualExchange) {
          let convFeeObj = conversionFee.find(e => e.countryCode == findCountry.countryCode);
          let convFee = convFeeObj ? convFeeObj.fees : 1.5;
          elementPrice = elementPrice + (elementPrice * convFee) / 100;
        }
      }
      elementPrice = to.configuration.priceRoundingObj ? priceByCountry.getRoundAmountNew(to, elementPrice) : elementPrice;

      elementPrice = elementPrice * 100;

      let finalElement = Shopify.formatMoney(elementPrice, userCountry.moneyFormat);

      return finalElement;
    } catch (error) {
      throw error;
    }
  },
  findMoneyElement: function (page, element, from, to, allMoney) {
    try {
      if (allMoney) {
        allMoney.forEach((money) => {
          if (money.element && !money.element.classList.contains("done")) {
            money.element.classList.add("done");
            // money.element.innerHTML = shopifyCurrency == to.currency ? money.element.innerHTML : priceByCountry.getConvertedElement(from, to, money.price);
            if (shopifyCurrency == defaultCurrency.currency) {
              if (shopifyCurrency == to.currency) {
                let elementPrice = to.configuration.priceRoundingObj ? priceByCountry.getRoundAmountNew(to, money.price) : money.price;
                elementPrice = elementPrice * 100;
                money.element.innerHTML = Shopify.formatMoney(elementPrice, to.moneyFormat);
              } else {
                money.element.innerHTML = priceByCountry.getConvertedElement(from, to, money.price);
              }
              // money.element.innerHTML = shopifyCurrency == to.currency ? money.element.innerHTML : priceByCountry.getConvertedElement(from, to, money.price);
            } else {
              makeDefaultVisible();
            }

          }
        });
      } else {
        let allMoney = element.querySelectorAll(".money");
        allMoney.forEach((money) => {
          if (money && !money.classList.contains("done")) {
            if (money.getElementsByClassName("money").length == 0) {
              let amount = this.getPrice(money);
              money.classList.add("done");
              // money.innerHTML = shopifyCurrency == to.currency ? money.innerHTML : priceByCountry.getConvertedElement(from, to, amount);
              if (shopifyCurrency == defaultCurrency.currency) {
                if (shopifyCurrency == to.currency) {
                  // money.innerHTML = priceByCountry.getRoundAmountNew(to,amout);
                  let elementPrice = to.configuration.priceRoundingObj ? priceByCountry.getRoundAmountNew(to, amount) : amount;
                  elementPrice = elementPrice * 100;
                  money.innerHTML = Shopify.formatMoney(elementPrice, to.moneyFormat);
                } else {
                  money.innerHTML = priceByCountry.getConvertedElement(from, to, amount);
                }
                // money.innerHTML = shopifyCurrency == to.currency ? money.innerHTML : priceByCountry.getConvertedElement(from, to, amount);
              } else {
                makeDefaultVisible();
              }
            }
          }
        });
      }
      if (pricingPlan == "Premium100" || pricingPlan == "Pricing By Country") {
        if (page == 'product') {
          priceByCountry.makeElementsVisible();
        } else {
          element.style.visibility = "visible";
        }
      }
      return true;
    } catch (error) {
      throw error;
    }
  },
  callPageFunction: function (selector) {
    try {
      if (selector.type == 'productDetail') {
        if (!selector.initialTime) { priceByCountry.productPage(selector); } else { setTimeout(() => { priceByCountry.productPage(selector); }, selector.initialTime); }
        if (selector.repeated) { setInterval(() => { priceByCountry.productPage(selector); }, selector.repeatedTime); }
      } else {
        if (!selector.initialTime) { priceByCountry.collectionPage(selector); } else { setTimeout(() => { priceByCountry.collectionPage(selector); }, selector.initialTime); }
        if (selector.repeated) { setInterval(() => { priceByCountry.collectionPage(selector); }, selector.repeatedTime); }
      }
    } catch (error) {
      throw error;
    }
  },
  makeElementsVisible: function () {
    try {
      pageSelectors.forEach(selector => {
        if (selector.type == 'productDetail') {
          let products = document.querySelectorAll(selector.selector);
          for (let i = 0; i < products.length; i++) {
            let product = products[i];
            let prices = product.querySelectorAll(selector.priceSelector);
            for (let j = 0; j < prices.length; j++) {
              let priceElement = prices[j];
              priceElement.style.visibility = "visible";
            }
          }
        }
      });
    } catch (error) {
      throw error;
    }
  },
  handlePage: function (data) {
    try {
      if (data && data.data) data = data.data;
      ipCountryData = data;
      priceByCountry.setCountry(ipCountryData);
      currentPage = priceByCountry.findPage();
      if (pricingPlan == "Premium100" || pricingPlan == "Pricing By Country") {
        pageSelectors = priceByCountry.findSelectors(currentPage);
        if (currentPage != 'cart') {
          pageSelectors.forEach(selector => {
            priceByCountry.callPageFunction(selector);
          });
        } else {
          priceByCountry.cartPage();
          autoUpdate('cart');
        }
      } else {
        setInterval(() => {
          setPrice(currentPage, defaultCountry);
        }, 2000);
      }
    } catch (error) {
      throw error;
    }
  },
  selectVariant: function (selector, product) {
    try {
      if (selector.siblingSelector && selector.siblingSelector.length > 0) {
        var nextVariantSelector = document.querySelectorAll(selector.siblingSelector);
        let variantElement = nextVariantSelector.length > 0 ? nextVariantSelector[0].nextElementSibling : null;
        if (variantElement) {
          if (variantElement.tagName.toLowerCase() == 'select') {
            priceByCountry.changeSelectValue(variantElement);
          } else {
            priceByCountry.findAndSelectVariant(variantElement);
          }
        }
      } else {
        variants = document.querySelectorAll(selector.variantSelector);
        variants.forEach((variant) => {
          if (variant.innerHTML.toLowerCase().indexOf("currencycountry") > -1) {
            priceByCountry.findAndSelectVariant(variant);
          }
        });
      }
    } catch (error) {
      throw error;
    }
  },
  changeSelectValue: function (select) {
    try {
      let countryFound = false;
      for (let i = 0; i < select.length; i++) {
        if (select.options[i].value == userCountry.countryCode) {
          countryFound = true;
          break;
        }
      }
      if (countryFound) {
        select.value = userCountry.countryCode;
      } else {
        select.value = "ROW"
      }
      e = new Event('change', { bubbles: true });
      select.dispatchEvent(e);
      select.click();
    } catch (error) {
      throw error;
    }
  },
  findAndSelectVariant: function (variant) {
    try {
      if (variant.querySelectorAll("select").length > 0) {
        let select = variant.querySelector("select");
        priceByCountry.changeSelectValue(select);
      } else if (variant.querySelectorAll("button").length > 0) {
        let buttons = variant.querySelectorAll("button");
        let countryFound = false;
        for (let i = 0; i < buttons.length; i++) {
          let button = buttons[i];
          if (button.getAttribute('data-value') && button.getAttribute('data-value') == userCountry.countryCode) {
            countryFound = true;
            break;
          }
        }
        let finalButton;
        if (countryFound) {
          finalButton = variant.querySelector("button[data-value=" + userCountry.countryCode + "]");
        } else {
          finalButton = variant.querySelector("button[data-value='ROW']");
        }
        if (finalButton) finalButton.click();
      } else if (variant.querySelectorAll("input[type='radio']").length > 0) {
        let radios = variant.querySelectorAll("input[type='radio']");
        let countryFound = false;
        for (let i = 0; i < radios.length; i++) {
          if (radios[i].value == userCountry.countryCode) {
            countryFound = true;
            break;
          }
        }
        let radio;
        if (countryFound) {
          radio = variant.querySelector("input[value=" + userCountry.countryCode + "]");
        } else {
          radio = variant.querySelector("input[value='ROW']");
        }
        if (radio) {
          radio.checked = true;
          e = new Event('change', { bubbles: true });
          radio.dispatchEvent(e);
        }
      } else {
        let lis = variant.querySelectorAll("li");
        let countryFound = false;
        for (let i = 0; i < lis.length; i++) {
          let val = lis[i].getAttribute("data-value") ? lis[i].getAttribute("data-value").toLowerCase() : '';
          if (val.length > 0 && val == userCountry.countryCode.toLowerCase()) {
            countryFound = true;
            break;
          }
        }
        let li;

        if (countryFound) {
          li = variant.querySelector("li[data-value=" + userCountry.countryCode.toLowerCase() + "]");
        } else {
          li = variant.querySelector("li[data-value='row']");
        }
        tmpVariant = variant;
        if (li) {
          e = new Event('click', { bubbles: true });
          li.dispatchEvent(e);
        }
      }
    } catch (error) {
      throw error;
    }
  },
  checkPrices: function (prices, from, to) {
    try {
      if (shopifyCurrency != userCountry.currency) {
        for (let i = 0; i < prices.length; i++) {
          const priceElement = prices[i];
          priceByCountry.findMoneyElement(
            'product',
            priceElement,
            from,
            to
          );
        }
      }

    } catch (error) {
      throw error;
    }
  },
  productPage: function (selector) {
    try {
      product = document.querySelector(selector.selector);
      if (product) {
        this.selectVariant(selector, product);
        let prices = product.querySelectorAll(selector.priceSelector);
        priceByCountry.checkPrices(prices, countrySetting.defaultCountry, userCountry);
        setPrice('product', countrySetting.defaultCountry);
      }
    } catch (error) {
      throw error;
    }
  },
  collectionPage: function (selector) {
    try {
      let collectionProducts = document.querySelectorAll(selector.selector);
      let bodyData = {
        urls: [],
        countryCode: countrySetting.userCountry.countryCode,
        userId: userId,
      };

      collectionProducts.forEach((element) => {
        if (!element.classList.contains("ws-pr-done")) {
          let tmpCollecLinkEle = element.querySelectorAll(selector.linkSelector)
          let collecLinkEle = tmpCollecLinkEle && tmpCollecLinkEle.length > 0 ? tmpCollecLinkEle[0] : null;
          if (collecLinkEle) {
            const handleArr = collecLinkEle.getAttribute("href").split("/");
            let tmpHandle = handleArr[handleArr.length - 1].split("?")[0];
            tmpHandle = decodeURI(tmpHandle);
            if (tmpHandle.length > 0) bodyData.urls.push(tmpHandle);
          }
        }
      });

      if (bodyData.urls.length > 0) {
        httpGetAsync(apiUrl + "collectionProducts", "POST", bodyData, (data) => {
          try {
            priceByCountry.patchCollectionData(data.data, selector);

          } catch (error) {
            throw error;
          }
        });
      }
    } catch (error) {
      throw error;
    }
  },
  patchCollectionData: function (data, selector) {
    try {
      let collections = document.querySelectorAll(selector.selector);
      collections.forEach((collection) => {
        collection.classList.add("ws-pr-done");
        let tmpLink = selector.linkSelector.replace(" >", " ");
        let linkElement = collection.querySelector(tmpLink);
        let link = linkElement ? linkElement.getAttribute("href") : null;
        let linkSplit = '';
        if (link) {
          link = link.split("?")[0];
          linkSplit = link.split("/")[link.split("/").length - 1];
        }

        const priceData = data.product.find(
          // (element) => link && link.indexOf(element.url) > -1
          (element) => linkSplit && linkSplit == element.url
        );
        if (priceData && priceData.price) {
          let tmpInnerHtml;
          if (priceData.compare_at_price) {
            tmpInnerHtml = '<span class="money pr-by-cr-m-original done">' + priceByCountry.getConvertedElement(countrySetting.defaultCountry, countrySetting.userCountry, priceData.price) + '</span> <span class="money pr-by-cr-m-comapre done" style="text-decoration: line-through;">' + priceByCountry.getConvertedElement(countrySetting.defaultCountry, countrySetting.userCountry, priceData.compare_at_price) + '</span>';
          } else {
            tmpInnerHtml = '<span class="money pr-by-cr-m-original done">' + priceByCountry.getConvertedElement(countrySetting.defaultCountry, countrySetting.userCountry, priceData.price) + '</span>';
          }
          if (collection.querySelector(selector.priceSelector)) {
            collection.querySelector(selector.priceSelector).innerHTML = tmpInnerHtml;
            collection.querySelector(selector.priceSelector).style.visibility = "visible";
            collection.querySelector(selector.priceSelector).classList.add("pr-by-cr-m");
          }
        } else {
          priceByCountry.manageCollection(selector, "convert");
        }
      });
    } catch (error) {
      throw error;
    }
  },
  cartPage: function () {
    try {
      this.findMoneyElement(
        'cart',
        document.querySelector("body"),
        countrySetting.defaultCountry,
        countrySetting.userCountry
      );
    } catch (error) {
      throw error;
    }
  },

  handleTestPage: function (data) {
    try {
      if (data) priceByCountry.handlePage(data);
    } catch (error) {
      throw error;
    }
  },
  prbcAddCss: function (css) {
    try {
      if (css && css.length > 0) {
        var css = css;
        var head = document.head || document.getElementsByTagName('head')[0],
          style = document.createElement('style');
        head.appendChild(style);
        style.type = 'text/css';
        if (style.styleSheet) {
          // This is required for IE8 and below.
          style.styleSheet.cssText = css;
        } else {
          style.appendChild(document.createTextNode(css));
        }
      }
    } catch (error) {
      throw error;
    }
  }
};

(function () {
  try {
    userId = getUrlParameter("id");
    // userId = "60364fb85631861ec508afcb";

    if (getParameterByName("pbc") || localStorage.getItem("prbcTestCountry")) {
      setTestBar();
      getAndSetAdminTestData();

    } else {
      httpGetAsync(
        "https://pro.ip-api.com/json?key=9ICbsngAdWQxmmq&fields=countryCode,currency,continentCode",
        "GET",
        null,
        priceByCountry.handlePage
      );
    }

  } catch (error) {
    console.log("Error:SelfInvoking-", error);
    makeDefaultVisible();
  }
})();

function httpGetAsync(theUrl, reqType, body, callback) {
  try {
    let xmlHttp = new XMLHttpRequest();
    xmlHttp.open(reqType, theUrl, true);
    xmlHttp.setRequestHeader("Content-Type", "application/json");
    xmlHttp.onreadystatechange = function () {
      try {
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
          if (callback) {
            callback(JSON.parse(xmlHttp.responseText));
          } else {
            return JSON.parse(xmlHttp.responseText);
          }
        } else if (xmlHttp.status != 200) {
          makeDefaultVisible();
        }
      } catch (error) {
        console.log("Error:httpGetAsync-", error);
        makeDefaultVisible();
      }
    };
    xmlHttp.send(JSON.stringify(body));
  } catch (error) {
    throw error;
  }
}

async function fetchPostAsync(type, url, body) {
  try {
    const rawResponse = await fetch(url, {
      method: type,
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded'
      },
      body: body
    });
    // const content = await rawResponse.json();
    return true;
  } catch (error) {
    throw error;
  }

}

function makeDefaultVisible() {
  let ele = document.getElementById("priceBlock");
  if (ele) ele.remove();
}

function getUrlParameter(name) {
  try {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    let regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
    let results = regex.exec(document.currentScript.src);
    return results === null
      ? ""
      : decodeURIComponent(results[1].replace(/\+/g, " "));
  } catch (error) {
    throw error
  }

}

function getParameterByName(name, url = window.location.href) {
  try {
    name = name.replace(/[\[\]]/g, "\\$&");
    let regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
      results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return "";
    return decodeURIComponent(results[2].replace(/\+/g, " "));
  } catch (error) {
    throw error
  }
}

function setPrice(page, from) {
  try {
    priceByCountry.findMoneyElement(
      page,
      document.querySelector("body"),
      from,
      userCountry
    );
  } catch (error) {
    throw error;
  }
}

function getCurrencySymbol(str) {
  try {
    return str.replace(/[\d\., ]/g, "");
  } catch (error) {
    throw error;
  }
}

Element.prototype.isVisible = function () {
  "use strict";
  function _isVisible(el, t, r, b, l, w, h) {
    let p = el.parentNode,
      VISIBLE_PADDING = 2;
    if (!_elementInDocument(el)) {
      return false;
    }
    if (9 === p.nodeType) {
      return true;
    }
    if (
      "0" === _getStyle(el, "opacity") ||
      "none" === _getStyle(el, "display") ||
      "hidden" === _getStyle(el, "visibility")
    ) {
      return false;
    }
    if (
      "undefined" === typeof t ||
      "undefined" === typeof r ||
      "undefined" === typeof b ||
      "undefined" === typeof l ||
      "undefined" === typeof w ||
      "undefined" === typeof h
    ) {
      t = el.offsetTop;
      l = el.offsetLeft;
      b = t + el.offsetHeight;
      r = l + el.offsetWidth;
      w = el.offsetWidth;
      h = el.offsetHeight;
    }
    if (p) {
      if (
        "hidden" === _getStyle(p, "overflow") ||
        "scroll" === _getStyle(p, "overflow")
      ) {
        if (
          l + VISIBLE_PADDING > p.offsetWidth + p.scrollLeft ||
          l + w - VISIBLE_PADDING < p.scrollLeft ||
          t + VISIBLE_PADDING > p.offsetHeight + p.scrollTop ||
          t + h - VISIBLE_PADDING < p.scrollTop
        ) {
          return false;
        }
      }
      if (el.offsetParent === p) {
        l += p.offsetLeft;
        t += p.offsetTop;
      }
      return _isVisible(p, t, r, b, l, w, h);
    }
    return true;
  }
  function _getStyle(el, property) {
    if (window.getComputedStyle) {
      return document.defaultView.getComputedStyle(el, null)[property];
    }
    if (el.currentStyle) {
      return el.currentStyle[property];
    }
  }
  function _elementInDocument(element) {
    while ((element = element.parentNode)) {
      if (element == document) {
        return true;
      }
    }
    return false;
  }
  return _isVisible(this);
};

if (generalCurrencySetting.configuration && generalCurrencySetting.configuration.customCss) {
  let style = document.createElement('style');
  style.innerHTML = JSON.parse(generalCurrencySetting.configuration.customCss);
  document.head.appendChild(style);
}
